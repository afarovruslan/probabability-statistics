\input{preamble}

\begin{document}
	\input{titlepage}
	\section{Байесовские оценки}
  \problem{
  $X_1 \sim Exp(\theta)$, $\theta$ имеет сопряженное априорное распределение $\Gamma(\alpha, \beta)$. Проверьте оценку $\theta^* = \frac{n + \beta}{\alpha + \sum_{i = 1}^n X_i}$ на состоятельность.
  }
  \solution{}
  \problem{
  По выборке $X_1, \dots, X_n$ из пуассоновского распределения с параметром $\theta$, где $\theta \sim \Gamma(\alpha, \lambda)$, постройте наилучшую оценку в байесовском подходе с квадратичной функцией потерь.
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из нормального распредения с параметрами $(\theta, 1)$. Найдите байесовскую оценку параметра $\theta$, если априорное распределение $\theta$ есть $Bin(1, p)$. Будет ли полученная оценка состоятельной оценкой параметра $\theta$?
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из равномерного распределения на отрезке $[0, \theta]$. Найдите байесовскую оценку параметра $\theta$, если $\theta$ имеет априорное распределение а) равномерно на отрезке $[0, 1]$, б) с плотностью $q(t) = 1/t^2$ при $t \ge 1$. Проверьте полученные оценки на состоятельность.
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из нормального распределения с параметрами $(\theta, 1)$. Найдите байесовскую оценку параметра $\theta$, если априорное распределение $\theta$ есть $\ND{b}{\sigma^2}$.}
  \solution{~}
  \section{Проверка гипотез и доверительное оценивание}
  \problem{
  $X_1, \dots, X_n$ - выборка из распределения с плотностью
  \[p_{\theta}(x) = \frac{3x^2}{8\theta^3}I_{[0, 2\theta]}(x)\]
  С помощью статистики $X_{(1)}$ постройте точный доверительный интервал уровня доверия $\gamma$ для параметра $\theta$.
  }
  \solution{}
  \problem{
  $X_1, \dots, X_n$ - выборка, $X_1 = \xi + \eta$, где $\xi$, $\eta$ - независимые случайные величины, $\xi \sim R[0, \theta], \eta \sim Bin(1, \theta)$. Постройте доверительный интервал для $\theta$ уровня доверия $1 - \alpha $ с помощью неравенства Чебышева.
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из гамма-распределения с параметрами $(\theta, \lambda)$. Постройте асимптотический доверительный интервал для $\theta$ уровня доверия $\alpha$, если а) $\lambda$ известно, б) $\lambda$ неизвестно.
  }
  \solution{}
  \problem{
  Имеется $X_1$ - выборка объема 1. Основная гипотеза $H_0$ состоит в том, что $X_1$ имеет равномерное распределение на отрезке $[0, 1]$, альтернатива - в том, что $X_1$ имеет показательное распределение с параметром 1. Постройте наиболее мощный критерий уровня значимости $\alpha$ для различения этих гипотез и вычислите его мощность.
  }
  \solution{}
  \problem{*
  Пусть $X_1, \dots, X_n$ - выборка из равномерного распределения на отрезке $[0, \theta], \theta > 0$. Постройте р.н.м.к. уровня значимости $\alpha$ для проверки гипотезы $H_0 : \theta = \theta_0$ против альтернативы $H_1: \theta \ne \theta_0$ в виде
\[S(X_1, \dots, X_n) = \{ X_{(n)} \le c\theta_0\} \cup \{ X_{(n)} > \theta_0 \}\]
  }
  \solution{}
  \problem{
  Пусть $\{P_{\theta}, \theta \in \Theta\}$ - семейство с невозрастающим отношением правдоподобия по статистике $T(X)$, а $\alpha < 1$ - некоторое положительное число. Постройте р.н.м.к. уровня значимости $\alpha$ для проверки гипотезы $H_0$ против альтернативы $H_1$ , где а) $H_0 : \theta \le \theta_0$ (или $\theta = \theta_0), H_1 : \theta > \theta_0 $;
б) $H_0 : \theta \ge \theta_0$ (или $\theta = \theta_0$ ), $H_1 : \theta < \theta_0$ .
  }
  \solution{}
  \problem{*
  Показать, что любой равномерно наиболее мощный несмещённый (т.е. $\inf_{\theta \in \Theta_0} \beta(\theta, S) \ge \sup_{\theta \in \Theta_1} \beta(\theta, S)$) критерий $S$ является допустимым, т.е. не существует другого критерия $R$, который был бы не менее мощен, чем $S$, при всех альтернативах и более мощен хотя бы при одной из альтернатив.}
  \solution{}
  \problem{
  Докажите, что в предположении гипотезы $H_0 : F = F_0$ для любого $x \in R$ выполнено
\[ F_n^*(x) \xrightarrow[n \to \infty]{\text{п. н.}} F_0(x)\]
  }
  \solution{}
  \begin{theorem}[А. Колмогорова, 12.2 из С2]
  В предположении верности гипотезы $H_0 : F = F_0$ имеет место равенство 
  \[\lim_{n \to \infty} P(\sqrt{n}D_n \le t) = K(t)\]
  \end{theorem}
  \problem{
  С помощью теоремы 1 докажите состоятельность критерия Колмогорова.

  }
  \solution{}
  \problem{
  Докажите, что при условии $0 \le X_{(1)} \le X_{(n)} \le 1$ справедливо равенство
\[\int_{0}^1 (F_n^*(y) - y)^2dy = \frac{1}{12n^2} + \frac{1}{n} \sum_{k = 1}^n (X_{(k)} - (2k - 1) / 2n)^2 \]
(с помощью этого представления часто вычисляется значение статистики $\omega^2$ , которая используется в критерии
Крамера–Мизеса–Смирнова).
  }
  \solution{}
  \problem{
  Цифры $0, 1, 2, \dots , 9$ среди $800$ первых десятичных знаков
числа $\pi$ появились \\$74, 92, 83, 79, 80, 73, 77, 75, 76, 91$ раз соответственно. С помощью хи-квадрат критерия проверьте гипотезу о согласии этих данных с законом равномерного распределения на множестве $\{0, 1, \dots , 9\}$ на уровне
значимости а) 0.05, б) 0.5, в) 0.8.
}
  \solution{}
  \problem{
  Среди $5000$ семей, имеющих трех детей, есть ровно $1010$ семей с тремя мальчиками, 2200 семей с двумя мальчиками и одной девочкой, 950 семей с одним мальчиком и двумя девочками (во всех остальных семьях все дети - девочки). Можно ли с уровнем значимости $\alpha = 0.02$ считать, что количество мальчиков $\xi$ в семье с тремя детьми имеет следующее распределение
\[
P(\xi = 0) = \theta, P(\xi = 1) = \theta, \]
\[P(\xi = 2) = 2\theta, P(\xi = 3) = 1 - 4\theta, \]
где $\theta \in (0, 1/4)$?
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из распределения:
а)$Bern(\theta)$, б)$Pois(\theta)$, в)$\ND{\theta}{1}$, г)$\exp(\theta)$.
Ростроить доверительный интервал для параметра $\theta$.
  }
  \solution{}
  \problem{
  Рассмотрим распределения Коши с плотностью $p_{\theta}(x) = \frac{1}{\pi(1 + (x - \theta)^2)}$. С помощью выборочной медианы построить доверительный интервал для $\theta^2$.
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из экспоненциального распределения с параметром $\theta$. Построить равномерно наиболее мощный критерий для проверки гипотезы $H_0 : \theta = \theta_0$ против альтернативы:
  а) $H_1 : \theta > \theta_0$; б) $H_1: \theta < \theta_0$
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из $Bern(\theta)$. Проверить гипотезу $H_0: \theta \le \theta_0$ против альтернативы $H_1 : \theta > \theta_0$
  }
  \solution{~}
  \section{Линейная регрессия. Проверка линейных гипотез.}
  \problem{
  Пусть
\[X_i = \beta_1 + i\beta_2 + \eps_0 + \dots + \eps_i ,\]
$i = 0, 1, \dots, n$, где $\beta_1 , \beta_2$ - неизвестные параметры, а $\eps_0 , \dots , \eps_n$ - независимые, распределенные по закону $\ND{0}{\sigma^2}$ случайные величины. Сведите задачу к линейной модели и найдите оценки наименьших квадратов для $\beta_1$ и $\beta_2$ , а также несмещенную оценку для $\sigma^2$.
  }
  \solution{
  Заметим, что $X_{i + 1} - X_i = \beta_2 + \eps_i$
  Запишем модель линейной регрессии:
  \[
  \begin{pmatrix}
  X_0 \\
  X_1 - X_0\\
  \vdots \\
  X_n - X_{n - 1}
  \end{pmatrix} = 
  \begin{pmatrix}
  1 & 0 \\
  0 & 1 \\
  \vdots & \vdots \\
  0 & 1
  \end{pmatrix}
  \begin{pmatrix}
  \beta_1 \\
  \beta_2
  \end{pmatrix} + \eps \ra
  \]
  $Z^TZ = 
  \begin{pmatrix}
  1 & 0 \\
  0 & n \\
  \end{pmatrix} \ra (Z^TZ)^{-1} = 
  \begin{pmatrix}
  1 & 0 \\
  0 & \frac{1}{n}
  \end{pmatrix} \ra \hat{\beta} = 
  \begin{pmatrix}
  1 & 0 \\
  0 & \frac{1}{n}
  \end{pmatrix} 
  \begin{pmatrix}
  1 & 0 & \cdots & 0\\
  0 & 1 & \cdots & 1
  \end{pmatrix} 
  \begin{pmatrix}
  X_0 \\
  X_1 - X_0\\
  \vdots \\
  X_n - X_{n - 1}
  \end{pmatrix} =
  \begin{pmatrix}
  X_0 \\
  \frac{X_n - X_0}{n}
  \end{pmatrix}, \hat{\sigma^2} = \frac{1}{n + 1 - 2}\norm{
  \begin{pmatrix}
  X_0 \\
  X_1 - X_0\\
  \vdots \\
  X_n - X_{n - 1}
  \end{pmatrix} - \begin{pmatrix}
  1 & 0 \\
  0 & 1 \\
  \vdots & \vdots \\
  0 & 1
  \end{pmatrix} 
  \begin{pmatrix}
  X_0 \\
  \frac{X_n - X_0}{n}
  \end{pmatrix}
  }^2 = \displaystyle \frac{1}{n - 1} \sum_{i = 1}^n \left(X_i - X_{i - 1} - \frac{X_n - X_0}{n}\right)^2
  = $ \[\frac{1}{n - 1} \sum_{i = 1}^n \left((X_i - X_{i - 1})^2 - 2(X_i - X_{i - 1}) \frac{X_n - X_0}{n} + \left(\frac{X_n - X_0}{n} \right)^2\right) = \] \[ \frac{1}{n - 1}\left(\sum_{i = 1}^n (X_i - X_{i - 1})^2 - \frac{(X_n - X_0)^2}{n}\right) 
  \]
  }
  \problem{
  Пусть $X_1, \dots, X_n$- выборка из нормального распределения с параметрами $(a, \sigma^2 )$. Докажите, что статистики $X$ и
\[ S^2 = \frac{1}{n}\sum_{i = 1}^n (X_i - \overline{X})^2\]
независимы и вычислите распределение статистики $nS^2$.
  }
  \solution{}
  \problem{
  Пусть $X_1, \dots, X_n$ - выборка из $\ND{a}{\sigma^2}$ (оба параметра неизвестны). Постройте точные доверительные интервалы для каждого из параметров $a, \sigma^2$.
  }
  \solution{}
  \problem{
  Взвешивание трех грузов массами $a$ и $b$ производится следующим образом: $n_1$ раз взвешивается первый груз (все ошибки измерения имеют распределение $\ND{0}{\sigma^2}), n_2$ раза взвешивается второй груз на тех же самых весах, затем $n_3$ раза на других весах взвешиваются первый и второй груз вместе, все ошибки измерения на которых имеют распределение $\ND{0}{3\sigma^2}$. Сведите задачу к линейной модели и найдите оценки наименьших квадратов для a и b, а также оптимальную оценку для $\sigma^2$.
  }
  \solution{
  \[
  \tilde{X} = 
  \begin{pmatrix}
  X_1 \\
  \vdots \\ 
  X_{n_1} \\
  X_{n_1 + 1} \\
  \vdots \\
  X_{n_1 + n_2}\\
  \frac{X_{n_1 + n_2 + 1}}{\sqrt{3}}\\
  \vdots\\
  \frac{X_{n_1 + n_2 + n_3}}{\sqrt{3}}
  \end{pmatrix} = 
  \begin{pmatrix}
  1 & 0 \\
  \vdots & \vdots \\
  1 & 0 \\
  0 & 1 \\
  \vdots & \vdots \\
  0 & 1 \\
  \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{3}} \\
  \vdots & \vdots \\
  \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{3}}
  \end{pmatrix}
  \begin{pmatrix}
  a \\ b
  \end{pmatrix} + \eps \ra Z^TZ =
  \begin{pmatrix}
  n_1 + \frac{n_3}{3} & \frac{n_3}{3} \\
  \frac{n_3}{3} & n_2 + \frac{n_3}{3}
  \end{pmatrix} \ra \] \[\det Z^TZ = n_1n_2 + \frac{n_3}{3}(n_1 + n_2) \ra
 (Z^TZ)^{-1} = \frac{1}{ n_1n_2 + \frac{n_3}{3}(n_1 + n_2)}
  \begin{pmatrix}
  n_2 + \frac{n_3}{3} & -\frac{n_3}{3} \\
  -\frac{n_3}{3} & n_1 + \frac{n_3}{3}
  \end{pmatrix},
   \]
   \[ Z^T\tilde{X} = 
   \begin{pmatrix}
    \displaystyle \sum_{i = 1}^{n_1} X_i + \frac{1}{3}\sum_{j = n_1 + n_2 + 1}^{n_1 + n_2 + n_3} X_j \\
    \displaystyle \sum_{k = n_1 + 1}^{n_1 + n_2} X_k + \frac{1}{3}\sum_{j = n_1 + n_2 + 1}^{n_1 + n_2 + n_3} X_j
   \end{pmatrix}, \text{ Пусть } S_1 =  \sum_{i = 1}^{n_1} X_i, S_2 = \sum_{k = n_1 + 1}^{n_1 + n_2} X_k, S_3 = \sum_{j = n_1 + n_2 + 1}^{n_1 + n_2 + n_3} X_j \ra
   \]
   \[
   \begin{pmatrix} \hat{a} \\ \hat{b} \end{pmatrix} =
   \frac{1}{ n_1n_2 + \frac{n_3}{3}(n_1 + n_2)}
   \begin{pmatrix}
   n_2(S_1 + \frac{S_3}{3}) + \frac{n_3}{3}(S_1 - S_2) \\
   n_1(S_2 + \frac{S_3}{3}) + \frac{n_3}{3}(S_2 - S_1)
   \end{pmatrix}
   \]

  }
  \problem{
  Пусть $X_i , i \in \{1, \dots, n \}$ - независимые случайные величины, распределенные по нормальному закону с параметрами $(a+bi, \sigma^2 )$. Постройте точные доверительные интервалы для параметров $ a, b, \sigma^2$.
  }
  \solution{}
  \problem{
  $X_1, \dots, X_n$ - выборка из распределения $\ND{a_1}{\sigma^2}, Y_1 , \dots , Y_m$ - выборка из распределения $\ND{a_2}{\sigma^2}, Z_1 , \dots , Z_k$ - выборка из распределения $\ND{a_3}{\sigma^2}$. Постройте $F$ -критерий размера $\alpha$ для проверки гипотезы а) $H_0 : a_1 = a_2$ и $a_1 + a_2 = a_3 $,
б) $H_0 : a_1 = 2a_2$ и $a_1 + 3a_2 = a_3$.
  }
  \solution{}
  \problem{
  Пусть $X_i \sim \ND{a}{i\sigma^2}$, $i = 1, \dots, n$, $Y_j \sim \ND{jb}{\sigma^2}, j =
  = 1, \dots , m$, - независимые случайные величины, где $a, b, \sigma^2$ - неизвестные параметры. Сведите задачу к линейной модели и постройте $F$ -критерий размера $\alpha$ для проверки гипотезы $H_0 : a + b = 1$.
  }
  \solution{
  \[
  \begin{pmatrix}
  \frac{X_1}{\sqrt{1}} \\
  \vdots \\
  \frac{X_n}{\sqrt{n}} \\
  \frac{Y_1}{\sqrt{1}} \\
  \vdots\\
  \frac{Y_m}{\sqrt{m}}
  \end{pmatrix} = 
  \begin{pmatrix}
  \frac{1}{\sqrt{1}} & 0 \\
  \vdots & \vdots \\
  \frac{1}{\sqrt{n}} & 0 \\
  0 & \frac{1}{\sqrt{1}} \\
  \vdots & \vdots \\
  0 & \frac{1}{\sqrt{m}}
  \end{pmatrix}
  \begin{pmatrix}
  a \\ b
  \end{pmatrix} + \eps
  \]
  }
  \problem{
  Используя метод линейной регрессии, постройте приближение функции $f(x)$ многочленом третьей степени по следующим данным:
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
\hline
$f(x_i)$ & 3.9 & 5.0 & 5.7 & 6.5 & 7.1 & 7.6 & 7.8 & 8.1 & 8.4 \\
\hline
$x_i$ & 4.0 & 5.2 & 6.1 & 7.0 & 7.9 & 8.6 & 8.9 & 9.5 & 9.9 \\
\hline
\end{tabular}
\end{center}
  }
  \solution{
  Пусть искомый многочлен равен $ax^3 + bx^2 + cx + d$. Тогда модель линейной регрессии выглядит следующим образом:
  \[
  \begin{pmatrix}
  f(x_1) \\
  \vdots \\
  f(x_9)
  \end{pmatrix} = 
  \begin{pmatrix}
  x_1^3 & x_1^2 & x_1 & 1 \\
  \vdots & \vdots & \vdots & \vdots \\
  x_9^3 & x_9^2 & x_9 & 1
  \end{pmatrix}
  \begin{pmatrix}
  a \\ b \\ c \\ d
  \end{pmatrix} + \eps
  \]
  Если считать это руками, то уйдет миллион лет и, кстати, если вычилять точно в виде дробей, оценивая $a/1000, b/100, c/10, d$, то получится такая матрица $(Z^TZ)^{-1}$
  \begin{center}
  \includegraphics[width=\textwidth]{pictures/29-1.png}
  \end{center}
  Поэтому приведем программу на python:
  \begin{python}
  import numpy as np

  X = [4.0, 5.2, 6.1, 7.0, 7.9, 8.6, 8.9, 9.5, 9.9]
  F = [3.9, 5.0, 5.7, 6.5, 7.1, 7.6, 7.8, 8.1, 8.4]
  Z = list(map(lambda x: [x**3, x**2, x, 1], X))
  Z_np = np.array(Z)
  F_np = np.array(F)
  theta = np.linalg.inv(Z_np.T @ Z_np) @ Z_np.T @ F_np
  a, b, c, d = theta
  print(a, b, c, d)
  \end{python} и получим 
  \[(a, b, c, d) = (-0.00100145912636040, -0.0114849959500949, 1.07154905548792, -0.137289441132785) \]
  Вроде неплохо:
  \begin{python}
  import matplotlib.pyplot as plt

  plt.scatter(X, F, alpha=0.5)
  xseq = np.linspace(min(X), max(X), num=100)
  plt.plot(xseq, a * xseq**3 + b * xseq**2 + c * xseq + d,
           label=f'y={round(a, 3)}x^3 + {round(b, 3)}x^2 + {round(c, 3)}x + {round(d, 3)}')
  plt.legend()
  plt.show()
  \end{python}
  \begin{center}
  \includegraphics[width=0.5\textwidth]{pictures/29-2.png}
  \end{center}
  }
  \problem{
  Убедиться в том, что наиболее мощный критерий для различения двух простых гипотез о симметричном относитлтеьно нуля распределении набдюдаемой случайной величины $\xi \text{ } H_0 \text{  } \LL(\xi) = R[-a, a]$ и $H_1 \text{ } \LL(\xi) = \ND{0}{\sigma^2}$ ($a$ и $\sigma$ известны) имеет для больших выборок следующую асимптотическую форму 
  \[ \mathfrak{X_{1, a}^*} = \left\{ \sum_{i = 1}^n X_i^2 \le \frac{n}{3}a^2 + \zeta_a \frac{2a^2}{3}\sqrt{\frac{n}{5}}\right\}, \Phi(\zeta_a) = a\]
  }
  \guidance{
  Воспользоваться центральной предельной теоремой при отыскании распределения тестовой статистики.
  }
  \solution{}
  \problem{
  В последовательности независимых испытаний с двумя исходами вероятсноть ``успеха'' равна $p$. Построить критей проверки гипотезы $H_0 \text{ } p = 0$ против альтернативы $H_1 \text{ } p = 0.01$ и определить наименьший объем выборки, при котором вероятности ошибок 1-го и 2-го родов не превышают $0.01$.
  }
  \solution{}
  \problem{
  Имеется 2 гирьки с весами $\theta_1 $ и $\theta_2$. На одних и тех же весах сначала взвесили первую гирьку, затем вторую, а потом обе сразу. Найти оценку наименьших квадратов для $\theta_1$ и $\theta_2$ и несмещенную оценку дисперсии ошибки измерений. Проверьте гипотезы:
  а) $H_0 : \theta_1 = \theta_2$;
  б) $H_0 : 2\theta_1 = 3\theta_2$.
  }
  \solution{}
\end{document}